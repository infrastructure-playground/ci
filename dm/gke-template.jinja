{# resources:
- type:  gcp-types/container-v1beta1:projects.locations.clusters  # previously container.v1.clusters
  name: source-cluster
  properties:
   parent: projects/properties["projectName"]/locations/asia-east2
   cluster:
     name: source
     initialNodeCount: 3 #}

resources:
- name: {{ properties["projectName"] }}-gke-cluster
  type: container.v1.cluster
  properties:
    zone: asia-east2-a
    cluster:
      name: {{ properties["projectName"] }}-gke-cluster
      location: asia-east2
      initialClusterVersion: latest
      network: $(ref.{{ properties["projectName"] }}-network.selfLink)
      subnetwork: $(ref.{{ properties["projectName"] }}-network-asia-east2-subnet.selfLink)
      nodePools:
        - name: default-pool
          config:
            machineType: n1-standard-2
            # imageType: UBUNTU
            diskSizeGb: 10
            diskType: pd-ssd
            preemptible: True
            oauthScopes:
              - https://www.googleapis.com/auth/compute
              - https://www.googleapis.com/auth/devstorage.read_only
              - https://www.googleapis.com/auth/logging.write
              - https://www.googleapis.com/auth/monitoring
              - https://www.googleapis.com/auth/cloud_debugger
              - https://www.googleapis.com/auth/trace.append
          initialNodeCount: 1
          autoscaling:
            enabled: True
            minNodeCount: 1
            maxNodeCount: 100
          management:
            autoUpgrade: False
            autoRepair: True
      loggingService: logging.googleapis.com
      monitoringService: monitoring.googleapis.com